<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TS3明細</title>
</head>

<body>
    <button onclick="onClickCallCloseMiniApp()">Call closeMiniApp</button>
</body>

<script>
    /**
     * Android/iOS 共通
     */
    function closeMiniApp() {
        console.log("called closeMiniApp")
        const isAndroid = window.android != null
        console.log("isAndroid?: " + isAndroid)

        if (isAndroid) {
            // for Android
            window.android.closeMiniApp()
        } else {
            // for iOS
            window.webkit.messageHandlers.closeMiniApp.postMessage("")
        }
    }

    /**
     * クリックイベント
     */
    function onClickCallCloseMiniApp() {
        console.log("called onClickCallCloseMiniApp")

        // 実装検知
        if (window.android == null ||
            window.android.closeMiniApp == null
        ) {
            if (window.webkit == null ||
                window.webkit.messageHandlers == null ||
                window.webkit.messageHandlers.closeMiniApp == null
            ) {
                console.log("closeMiniApp メソッドが正しく実装されてません")
                return
            }
        }

        closeMiniApp()
    }
</script>

</html>
